import pandas as pd

cols=['conversation_id',
 'created_at','favorite_count',
 'full_text',
 'id',
 'reply_count',
 'retweet_count',
 'url',
 'user_advertiser_account_type',
 'user_business_profile_state',
 'user_contributors_enabled',
 'user_created_at',
 'user_default_profile_image',
 'user_ext_has_nft_avatar',
 'user_favourites_count',
 'user_followers_count',
 'user_friends_count',
 'user_geo_enabled',
 'user_has_custom_timelines',
 'user_id',
 'user_id_str',
 'user_is_translation_enabled',
 'user_is_translator',
 'user_listed_count',
 'user_normal_followers_count',
 'user_profile_background_color',
 'user_profile_background_tile',
 'user_profile_sidebar_border_color',
 'user_profile_sidebar_fill_color',
 'user_profile_text_color',
 'user_profile_use_background_image',
 'user_protected',
 'user_require_some_consent',
 'user_screen_name',
 'user_statuses_count',
 'user_translator_type',
 'user_verified',
 'user_location']

df_pavel = pd.read_csv('in/tables/twitter_pavel.csv',low_memory=False,usecols=cols)

df_babis = pd.read_csv('in/tables/twitter_babis.csv',low_memory=False,usecols=cols)

df_janecek = pd.read_csv('in/tables/twitter_janecek.csv',low_memory=False,usecols=cols)

df_nerudova=pd.read_csv('in/tables/twitter_nerudova.csv',low_memory=False,usecols=cols)

df_stredula=pd.read_csv('in/tables/twitter_stredula.csv',low_memory=False,usecols=cols)


# pÅ™idÃ¡nÃ­ chybÄ›jÃ­cÃ­ho sloupce - definujÃ­cÃ­ ke kterÃ©mu kandidÃ¡tovi danÃ½ post patÅ™Ã­

df_pavel['candidate'] = 'Pavel'

df_babis['candidate'] = 'Babis'

df_janecek['candidate'] = 'Janecek'

df_nerudova['candidate'] = 'Nerudova'

df_stredula['candidate'] = 'Stredula'


# kontrolnÃ­ mÄ›Å™enÃ­ - opravdu se nÃ¡m vÅ¡e sprÃ¡vnÄ› naÄetlo? 

len(df_pavel) + len(df_babis) 

len(df_janecek) + len(df_nerudova) 

len(df_stredula)


#spojenÃ­ datasetÅ¯ po kandidÃ¡tech do jednoho

df_all = pd.concat([df_pavel, df_babis, df_janecek, df_nerudova, df_stredula])

df_all

df_all.to_csv('out/tables/twitter_all2.csv')


# pÅ™evednÃ­ vÅ¡ech pÃ­smen ve sloupci full_text - sloupec obsahujÃ­cÃ­ text mention na malÃ¡ pÃ­smena - nutnÃ½ krok pro nÃ¡slednou analÃ½zu

one_col = df_all['full_text'].str.lower()

#type(a)

lst = list(one_col) # list of strings

lst.remove('a')

list_of_lists = [string.split(' ') for string in lst ]

flat_list = []
for inner_lst in list_of_lists:
    for word in inner_lst:
        flat_list.append(word)

from collections import Counter

counts = Counter(flat_list)


counts.most_common(2000)

list_3 = ( 'tomu',  'vÃ­te',  'tom',  'tak',  'tÃ­m',  'vÃ­m',  'nic',  'rÃ¡d',  'vÃ¡s',  'to',  'ne',  'je',  'se',  
          'jo',  'si',  'no',  'vy',  'ty',  'vÃ­',  '',  'je',  'se',  'na',  'v',  'Å¾e',  'tak',  'si',  'co',  
          'ale',  's',  'za',  'by',  'z',  '',  'do',  'o',  'uÅ¾',  'ty',  'i',  'jak',  'jen',  'pro',  'k',  'ze',  
          've',  'vy',  'tam',  'ten',  'ani',  'byl',  'mÃ¡',  'od',  'jÃ¡',  'po',  'jsi',  'u',  'aby',  'asi',  'tu',  
          'kdo',  'vÃ¡m',  'vÃ¡s',  '-',  'neÅ¾',  'ho',  'nic',  'mi',  'bÃ½t',  'mu',  'ti',  'mÄ›',  'teÄ',  '?',  'no',  
          'ne',  'tom',  'ta',  'on',  'tÃ­m',  'aÅ¾',  'pak',  'mÄ›l',  'bez',  'kde',  'nÃ¡s',  'moc',  'jim',  'pan',  'the',  
          'mÃ­t',  'kdy',  'let',  '.',  'nÃ¡m',  'svÃ©',  '...',  'mÃ¡m',  'aÅ¥',  'my',  'uz',  'ğŸ˜‚',  'jde',  'Är',  'vÃ­c',  'ji', 
          'tÃ©',  'of',  'pod',  'mÃ¡Å¡',  'pÅ™i',  'vÃ¡Å¡',  'in',  'vÅ¡e',  'jo',  'ja',  'tÄ›',  'ke',  'pÃ¡r',  'oni',  'nÄ›j',  'and', 
          '!',  'ğŸ¤”',  'ne?',  'mÅ¯j',  'ne.',  'nad',  'is',  'dva',  'co?',  'rÃ¡d',  '2',  'Äi',  'ab',  'kam',  'ma',  '8',  'mne', 
          'den',  'jiÅ¾',  'coÅ¾',  'ono',  'for',  'vas',  'ÄÃ­m',  '..',  'sem',  'jÃ­',  'â€¦',  'jdi',  'Å¾e?',  'dal',  'dÃ¡',  'ted', 
          'byt',  'dÃ¡l',  ':d',  'pr',  'zda',  'rok',  'Äem',  'mnÄ›',  'me',  'dle',  '10',  '30',  'seÅ¡',  'sa',  'nÃ­',  'zde', 
          'Äas',  'vam',  'ses',  'nÃ­m',  'zas',  'bys',  'ona',  'pp',  'umÃ­',  '3',  '5',  'tou',  'vÃ­',  'jÃ­t',  'at',  'prÃ½',  'ğŸ¤®', 
          'it',  'je.',  'buÄ',  'dÃ¡t',  '000',  'ğŸ˜Š',  'nÄ›',  'tÄ›m',  'nez',  '4',  'tim',  'vÃ­Å¡',  '100',  'oba',  '%',  '!!!',  'to.', 
          'nÃ¡Å¡',  '1',  'cca',  'p.',  'te',  'az',  '=',  'vy.',  'dvÄ›',  'mel',  'nÄ›m',  'you',  'nas',  'se.',  'we',  'de',  ':))', 
          '20',  'jej',  'pÃ¡n',  '"',  'Å¡el',  'lze',  'drÅ¾',  'vÃ­m',  'pÅ¯l',  '50',  'tÅ™i',  'be')

counts_most_common = counts.most_common(2000)
counts2 = [x for x in counts_most_common if x[0] not in list_3]
counts2
